<style>
  .ds-lp-testimonials {
    background: linear-gradient(180deg, #FDF1E9 0%, #F9C9A7 100%);
    padding: 0px 20px 64px;
    position: relative;
    overflow: hidden;
  }
  
  .ds-lp-testimonials__video-carousel-wrapper {
    position: relative;
  }

  .ds-lp-testimonials__video-carousel {
    width: 100%;
    overflow: visible;
    /* padding-bottom: 30px; */
  }
  
  .ds-lp-testimonials__video-carousel .slick-list {
    overflow: visible;
  }
  
  .ds-lp-testimonials__video-carousel .slick-track {
    display: flex !important;
  }
  
  .ds-lp-testimonials__video-carousel .slick-list .slick-slide {
    padding: 0 8px; /* 16px gap total (8px on each side) */
    height: inherit !important;
  }
  
  .ds-lp-testimonials__video-item {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    aspect-ratio: 9 / 16;
    width: 100%;
  }
  
  .ds-lp-testimonials__video-item.is-playing .ds-lp-testimonials__video-thumbnail,
  .ds-lp-testimonials__video-item.is-playing .ds-lp-testimonials__play-button {
    display: none;
  }
  
  .ds-lp-testimonials__inline-video {
    width: 100%;
    height: 100%;
    display: block;
    border-radius: 12px;
    background: #000000;
    object-fit: cover;
  }
  
  @media (min-width: 768px) {
    .ds-lp-testimonials__video-carousel {
      overflow: hidden;
    }
    
    .ds-lp-testimonials__video-carousel .slick-list {
      overflow: hidden;
    }
    
    .ds-lp-testimonials__video-carousel .slick-list .slick-slide {
      padding: 0 24px; /* 48px gap total (24px on each side) */
    }
  }
  
  .ds-lp-testimonials__video-thumbnail {
    width: 100%;
    height: 100%;
    display: block;
    border-radius: 12px;
    object-fit: cover;
  }
  
  .ds-lp-testimonials__play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 60px;
    height: 60px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .ds-lp-testimonials__play-button:hover {
    background: rgba(255, 255, 255, 1);
    transform: translate(-50%, -50%) scale(1.1);
  }
  
  .ds-lp-testimonials__play-button svg {
    width: 54px;
    height: 54px;
  }
  
  .ds-lp-testimonials__testimonial-carousel {
    width: 100%;
    /* padding-bottom: 30px; */
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-list {
    overflow: hidden;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-track {
    display: flex !important;
    align-items: stretch;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-list .slick-slide {
    padding: 0;
    height: auto;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-slide {
    height: auto;
    display: flex;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-slide > div {
    height: 100%;
    display: flex;
  }
  
  .ds-lp-testimonials__testimonial-item {
    height: 100%;
    display: flex;
    width: 100%;
  }
  
  .ds-lp-testimonials__testimonial-card {
    background: #FFFFFF;
    border: 1px solid #000000;
    border-radius: 20px;
    padding: 24px 24px 76px 24px;
    position: relative;
    /* max-width: 900px; */
    margin: 0 auto;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .ds-lp-testimonials__testimonial-carousel {
    position: relative;
  }
  
  .ds-lp-testimonials__stars {
    display: flex;
    gap: 4px;
    justify-content: center;
    margin-bottom: 24px;
  }
  
  .ds-lp-testimonials__quote {
    font-size: 20px;
    line-height: 1.4;
    letter-spacing: -1px;
    color: #000000;
    text-align: center;
    margin-bottom: 24px;
    font-weight: 700;
  }
  
  .ds-lp-testimonials__attribution {
    text-align: center;
    font-size: 14px;
    line-height: 1.4;
    letter-spacing: -0.7px;
    color: #000000;
    margin-bottom: 24px;
    font-weight: 600;
  }

  .ds-lp-testimonials__attribution strong{
    font-weight: 600;
  }
  
  .ds-lp-testimonials__profile-image {
    position: absolute;
    right: -30px;
    top: 50%;
    transform: translateY(-50%);
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #FFFFFF;
  }
  
  /* Slick dots customization */
  .ds-lp-testimonials__testimonial-carousel .slick-dots {
    display: flex;
    gap: 8px;
    justify-content: center;
    list-style: none;
    padding: 0;
    margin: 0;
    position: absolute;
    bottom: 64px;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    z-index: 10;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-dots li {
    width: 8px;
    height: 8px;
    margin: 0;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-dots li button {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #D1D1D1;
    border: none;
    padding: 0;
    font-size: 0;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .ds-lp-testimonials__testimonial-carousel .slick-dots li.slick-active button {
    background: #000000;
  }
  
  /* Custom arrow buttons */
  .ds-lp-testimonials__arrow,
  .ds-lp-testimonials__video-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 20;
    cursor: pointer;
    background: transparent;
    border: none;
    padding: 0;
    display: none;
    transition: opacity 0.3s ease;
  }
  
  .ds-lp-testimonials__arrow:hover,
  .ds-lp-testimonials__video-arrow:hover {
    opacity: 0.7;
  }
  
  .ds-lp-testimonials__arrow--prev {
    left: 40px;
  }
  
  .ds-lp-testimonials__arrow--next {
    right: 40px;
  }
  
  .ds-lp-testimonials__arrow svg,
  .ds-lp-testimonials__video-arrow svg {
    display: block;
    width: 48px;
    height: 48px;
  }

  .ds-lp-testimonials__video-arrow--prev {
    left: 0;
  }

  .ds-lp-testimonials__video-arrow--next {
    right: 0;
  }
  
  @media (min-width: 1024px) {
    .ds-lp-testimonials {
      padding: 80px 65px;
    }

    .ds-lp-testimonials__stars{
        margin-bottom: 32px;
    }
    
    .ds-lp-testimonials__testimonial-card {
      padding: 48px 20% 96px;
    }
    
    .ds-lp-testimonials__quote {
      font-size: 32px;
      letter-spacing: -1.6px;
      margin-bottom: 32px;
    }

    .ds-lp-testimonials__attribution{
        font-size: 18px;
        letter-spacing: -0.9px;
    }
    
    .ds-lp-testimonials__arrow,
    .ds-lp-testimonials__video-arrow {
      display: block;
    }
    
    .ds-lp-testimonials__testimonial-carousel-wrapper {
      position: relative;
    }
    
    .ds-lp-testimonials__profile-image {
      width: 100px;
      height: 100px;
      right: -40px;
    }
    .ds-lp-testimonials__video-carousel-wrapper {
      padding: 0 64px;
    }
  }

  @media (max-width: 1023px) {
    .ds-lp-testimonials__arrow,
    .ds-lp-testimonials__video-arrow {
      display: none !important;
    }
  }
</style>

<section class="ds-lp-testimonials" id="ds-lp--testimonials">
  <div class=" mx-auto">
    {% comment %} Section Label {% endcomment %}
    {% if section.settings.label != blank %}
      <div class="text-center text-sm font-bold leading-[1.5] tracking-[-0.7px] mb-4" style="color: {{ section.settings.label_color | default: '#EC008C' }};">
        {{ section.settings.label }}
      </div>
    {% endif %}
    
    {% comment %} Headline {% endcomment %}
    {% if section.settings.headline != blank %}
      <div class="w-4/5 max-w-xl mx-auto text-center text-[32px] lg:text-[48px] font-bold leading-[1.2] tracking-[-1.6px] lg:tracking-[-2.4px] mb-6 lg:mb-10 text-black">
        {{ section.settings.headline }}
      </div>
    {% endif %}
    
    {% comment %} Tagline {% endcomment %}
    {% if section.settings.tagline != blank %}
      <div class="w-3/5 mx-auto text-center text-base lg:text-lg text-black leading-[1.5] tracking-[-0.8px] lg:tracking-[-0.9px] mb-12 lg:mb-20">
        {{ section.settings.tagline }}
      </div>
    {% endif %}
    
    {% comment %} Video Carousel {% endcomment %}
    {% assign video_blocks = section.blocks | where: 'type', 'ugc_video' %}
    {% if video_blocks.size > 0 %}
      <div class="ds-lp-testimonials__video-carousel-wrapper mb-12 lg:mb-20">
        <button type="button" class="ds-lp-testimonials__video-arrow ds-lp-testimonials__video-arrow--prev" aria-label="Previous video">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.5" y="0.5" width="47" height="47" rx="23.5" stroke="black"/>
            <path d="M32 23H19.83L25.42 17.41L24 16L16 24L24 32L25.41 30.59L19.83 25H32V23Z" fill="black"/>
          </svg>
        </button>
        <div class="ds-lp-testimonials__video-carousel slick--testimonials-videos">
          {% for block in video_blocks %}
          <div class="ds-lp-testimonials__video-item" data-block-id="{{ block.id }}">
              {% assign fallback_video_thumb = '' %}
              {% if block.settings.video_thumbnail == blank and block.settings.video_url != blank %}
                {% assign raw_video_url = block.settings.video_url %}
                {% if raw_video_url contains 'youtu.be/' %}
                  {% assign fallback_video_thumb = raw_video_url | split: 'youtu.be/' | last | split: '?' | first %}
                  {% assign fallback_video_thumb = 'https://img.youtube.com/vi/' | append: fallback_video_thumb | append: '/hqdefault.jpg' %}
                {% elsif raw_video_url contains 'youtube.com/watch' %}
                  {% assign fallback_video_thumb = raw_video_url | split: 'v=' | last | split: '&' | first %}
                  {% assign fallback_video_thumb = 'https://img.youtube.com/vi/' | append: fallback_video_thumb | append: '/hqdefault.jpg' %}
                {% elsif raw_video_url contains 'vimeo.com/' %}
                  {% assign fallback_video_thumb = raw_video_url | split: 'vimeo.com/' | last | split: '?' | first | split: '/' | last %}
                  {% assign fallback_video_thumb = 'https://vumbnail.com/' | append: fallback_video_thumb | append: '.jpg' %}
                {% endif %}
              {% endif %}

              {% if block.settings.video_thumbnail != blank %}
                {% assign thumb_img = block.settings.video_thumbnail %}
                {% if thumb_img.src contains '.svg' or thumb_img.width == blank %}
                  <img 
                    src="{{ thumb_img | image_url }}"
                    alt="{{ block.settings.video_alt | default: 'Video testimonial' | escape }}"
                    class="ds-lp-testimonials__video-thumbnail"
                    width="400"
                    height="300"
                    loading="lazy"
                  >
                {% else %}
                  <img 
                    src="{{ thumb_img | image_url: width: 800 }}"
                    srcset="{{ thumb_img | image_url: width: 400 }} 400w, {{ thumb_img | image_url: width: 800 }} 800w"
                    sizes="(min-width: 768px) 33vw, 100vw"
                    alt="{{ block.settings.video_alt | default: 'Video testimonial' | escape }}"
                    class="ds-lp-testimonials__video-thumbnail"
                    width="{{ thumb_img.width }}"
                    height="{{ thumb_img.height }}"
                    loading="lazy"
                  >
                {% endif %}
              {% elsif fallback_video_thumb != blank %} 
                <img 
                  src="{{ fallback_video_thumb }}"
                  alt="{{ block.settings.video_alt | default: 'Video testimonial' | escape }}"
                  class="ds-lp-testimonials__video-thumbnail"
                  width="400"
                  height="300"
                  loading="lazy"
                >
              {% elsif block.settings.video_url != blank %}
                <video
                  class="ds-lp-testimonials__video-thumbnail"
                  muted
                  playsinline
                  preload="metadata"
                  aria-hidden="true"
                >
                  <source src="{{ block.settings.video_url }}" type="video/mp4">
                </video>
              {% endif %}
              
              {% if block.settings.video_url != blank %}
                <button type="button" class="ds-lp-testimonials__play-button" onclick="openVideo(event, '{{ block.settings.video_url }}')">
                  <svg width="54" height="54" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M0 26.6667C0 11.9391 11.9391 0 26.6667 0C33.7391 0 40.5219 2.80952 45.5229 7.81046C50.5238 12.8115 53.3333 19.5943 53.3333 26.6667C53.3333 41.3943 41.3943 53.3334 26.6667 53.3334C11.9391 53.3334 0 41.3943 0 26.6667ZM21.7868 38.0801L37.3334 28.3734C37.9152 28.0008 38.2671 27.3576 38.2671 26.6667C38.2671 25.9759 37.9152 25.3326 37.3334 24.9601L21.7334 15.2534C21.119 14.866 20.3428 14.8422 19.7058 15.1911C19.0688 15.5401 18.671 16.207 18.6668 16.9334V36.4001C18.6582 37.1441 19.0633 37.8314 19.7184 38.1841C20.3735 38.5369 21.1703 38.4968 21.7868 38.0801Z" fill="white"/>
                  </svg>
                </button>
              {% endif %}
          </div>
          {% endfor %}
        </div>
        <button type="button" class="ds-lp-testimonials__video-arrow ds-lp-testimonials__video-arrow--next" aria-label="Next video">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.5" y="0.5" width="47" height="47" rx="23.5" stroke="black"/>
            <path d="M24 16L22.59 17.41L28.17 23H16V25H28.17L22.59 30.59L24 32L32 24L24 16Z" fill="black"/>
          </svg>
        </button>
      </div>
    {% endif %}
    
    {% comment %} Testimonial Carousel {% endcomment %}
    {% assign testimonial_blocks = section.blocks | where: 'type', 'testimonial' %}
    {% if testimonial_blocks.size > 0 %}
      <div class="ds-lp-testimonials__testimonial-carousel-wrapper">
        <button type="button" class="ds-lp-testimonials__arrow ds-lp-testimonials__arrow--prev" aria-label="Previous testimonial">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.5" y="0.5" width="47" height="47" rx="23.5" stroke="black"/>
            <path d="M32 23H19.83L25.42 17.41L24 16L16 24L24 32L25.41 30.59L19.83 25H32V23Z" fill="black"/>
          </svg>
        </button>
        <div class="ds-lp-testimonials__testimonial-carousel slick--testimonials">
        {% for block in testimonial_blocks %}
          <div class="ds-lp-testimonials__testimonial-item" data-block-id="{{ block.id }}">
            <div class="ds-lp-testimonials__testimonial-card">
                {% comment %} Stars {% endcomment %}
                {% if block.settings.rating != blank %}
                  <div class="ds-lp-testimonials__stars">
                    {% assign rating = block.settings.rating | times: 1 %}
                    {% for i in (1..5) %}
                      {% if i <= rating %}
                        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M9.0709 0.615945C9.41464 -0.205316 10.5854 -0.205315 10.9291 0.615947L12.9579 5.46318C13.1029 5.8094 13.4306 6.04596 13.8067 6.07593L19.0727 6.49546C19.9649 6.56654 20.3267 7.673 19.6469 8.25165L15.6348 11.6669C15.3483 11.9109 15.223 12.2937 15.3106 12.6583L16.5364 17.7649C16.744 18.63 15.7969 19.3139 15.033 18.8503L10.5246 16.1138C10.2025 15.9183 9.79752 15.9183 9.4755 16.1138L4.967 18.8503C4.20312 19.3139 3.25596 18.63 3.46364 17.7649L4.68943 12.6583C4.77699 12.2937 4.65183 11.9109 4.36527 11.6669L0.353063 8.25165C-0.326719 7.673 0.0350679 6.56654 0.927293 6.49546L6.19337 6.07593C6.56952 6.04596 6.89717 5.8094 7.04208 5.46318L9.0709 0.615945Z" fill="#FFD32C"/>
                        </svg>
                      {% else %}
                        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M9.0709 0.615945C9.41464 -0.205316 10.5854 -0.205315 10.9291 0.615947L12.9579 5.46318C13.1029 5.8094 13.4306 6.04596 13.8067 6.07593L19.0727 6.49546C19.9649 6.56654 20.3267 7.673 19.6469 8.25165L15.6348 11.6669C15.3483 11.9109 15.223 12.2937 15.3106 12.6583L16.5364 17.7649C16.744 18.63 15.7969 19.3139 15.033 18.8503L10.5246 16.1138C10.2025 15.9183 9.79752 15.9183 9.4755 16.1138L4.967 18.8503C4.20312 19.3139 3.25596 18.63 3.46364 17.7649L4.68943 12.6583C4.77699 12.2937 4.65183 11.9109 4.36527 11.6669L0.353063 8.25165C-0.326719 7.673 0.0350679 6.56654 0.927293 6.49546L6.19337 6.07593C6.56952 6.04596 6.89717 5.8094 7.04208 5.46318L9.0709 0.615945Z" fill="#E5E5E5"/>
                        </svg>
                      {% endif %}
                    {% endfor %}
                  </div>
                {% endif %}
                
                {% comment %} Quote {% endcomment %}
                {% if block.settings.quote != blank %}
                  <div class="ds-lp-testimonials__quote">
                    "{{ block.settings.quote }}"
                  </div>
                {% endif %}
                
                {% comment %} Attribution {% endcomment %}
                {% if block.settings.customer_name != blank or block.settings.customer_title != blank %}
                  <div class="ds-lp-testimonials__attribution">
                    {% if block.settings.customer_name != blank %}
                      <strong>{{ block.settings.customer_name }}</strong>{% if block.settings.customer_title != blank %}, {% endif %}
                    {% endif %}
                    {% if block.settings.customer_title != blank %}
                      {{ block.settings.customer_title }}
                    {% endif %}
                  </div>
                {% endif %}
                
                {% comment %} Profile Image {% endcomment %}
                {% if block.settings.profile_image != blank %}
                  {% assign profile_img = block.settings.profile_image %}
                  {% if profile_img.src contains '.svg' or profile_img.width == blank %}
                    <img 
                      src="{{ profile_img | image_url }}"
                      alt="{{ block.settings.customer_name | default: 'Customer' | escape }}"
                      class="ds-lp-testimonials__profile-image"
                      width="80"
                      height="80"
                      loading="lazy"
                    >
                  {% else %}
                    <img 
                      src="{{ profile_img | image_url: width: 200 }}"
                      srcset="{{ profile_img | image_url: width: 160 }} 160w, {{ profile_img | image_url: width: 200 }} 200w"
                      sizes="80px"
                      alt="{{ block.settings.customer_name | default: 'Customer' | escape }}"
                      class="ds-lp-testimonials__profile-image"
                      width="{{ profile_img.width }}"
                      height="{{ profile_img.height }}"
                      loading="lazy"
                    >
                  {% endif %}
                {% endif %}
            </div>
          </div>
        {% endfor %}
        </div>
        <button type="button" class="ds-lp-testimonials__arrow ds-lp-testimonials__arrow--next" aria-label="Next testimonial">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.5" y="0.5" width="47" height="47" rx="23.5" stroke="black"/>
            <path d="M24 16L22.59 17.41L28.17 23H16V25H28.17L22.59 30.59L24 32L32 24L24 16Z" fill="black"/>
          </svg>
        </button>
      </div>
    {% endif %}
  </div>
</section>

<script>
(function() {
  var sectionId = '{{ section.id }}';
  var videoCarouselSelector = '#shopify-section-' + sectionId + ' .slick--testimonials-videos';
  var testimonialCarouselSelector = '#shopify-section-' + sectionId + ' .slick--testimonials';
  
  $(document).ready(function(){
    // Video carousel
    if ($(videoCarouselSelector).length && !$(videoCarouselSelector).hasClass('slick-initialized')) {
      var $videoCarousel = $(videoCarouselSelector);
      var $videoWrapper = $videoCarousel.closest('.ds-lp-testimonials__video-carousel-wrapper');
      var $videoPrevArrow = $videoWrapper.find('.ds-lp-testimonials__video-arrow--prev');
      var $videoNextArrow = $videoWrapper.find('.ds-lp-testimonials__video-arrow--next');

      $videoCarousel.slick({
        infinite: true,
        centerMode: true,
        speed: 300,
        slidesToShow: 1,
        slidesToScroll: 1,
        dots: false,
        arrows: true,
        prevArrow: $videoPrevArrow,
        nextArrow: $videoNextArrow,
        mobileFirst: true,
        responsive: [
          {
            breakpoint: 768,
            settings: {
              slidesToShow: 3,
              slidesToScroll: 1,
              infinite: true,
              centerMode: false,
              dots: false
            }
          }
        ]
      });
    }
    
    // Testimonial carousel
    if ($(testimonialCarouselSelector).length && !$(testimonialCarouselSelector).hasClass('slick-initialized')) {
      var $testimonialCarousel = $(testimonialCarouselSelector);
      var $wrapper = $testimonialCarousel.closest('.ds-lp-testimonials__testimonial-carousel-wrapper');
      var $prevArrow = $wrapper.find('.ds-lp-testimonials__arrow--prev');
      var $nextArrow = $wrapper.find('.ds-lp-testimonials__arrow--next');
      
      $testimonialCarousel.slick({
        infinite: true,
        speed: 300,
        slidesToShow: 1,
        slidesToScroll: 1,
        dots: true,
        arrows: true,
        prevArrow: $prevArrow,
        nextArrow: $nextArrow,
        mobileFirst: true,
        adaptiveHeight: true
      });
    }
  });
})();

function openVideo(event, url) {
  if (event && event.preventDefault) {
    event.preventDefault();
    event.stopPropagation();
  }
  
  var button = event && event.currentTarget ? event.currentTarget : null;
  var container = button ? button.closest('.ds-lp-testimonials__video-item') : null;
  var isInlineVideo = url && (url.indexOf('cdn.shopify.com') !== -1 || /\.(mp4|mov|webm)(\?|$)/i.test(url));
  
  if (isInlineVideo && container) {
    container.classList.add('is-playing');
    var existingPlayer = container.querySelector('.ds-lp-testimonials__inline-video');
    var videoEl = existingPlayer;
    
    if (!existingPlayer) {
      videoEl = document.createElement('video');
      videoEl.className = 'ds-lp-testimonials__inline-video';
      videoEl.setAttribute('playsinline', '');
      videoEl.setAttribute('controls', '');
      videoEl.setAttribute('muted', '');
      videoEl.src = url;
      container.appendChild(videoEl);
    }
    
    videoEl.currentTime = 0;
    var playPromise = videoEl.play();
    if (playPromise && playPromise.catch) {
      playPromise.catch(function() {
        videoEl.muted = true;
        videoEl.play();
      });
    }
    return;
  }
  
  if (url && (url.includes('youtube.com') || url.includes('youtu.be'))) {
    const videoId = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/)?.[1];
    if (videoId) {
      window.open(`https://www.youtube.com/embed/${videoId}?autoplay=1`, '_blank');
      return;
    }
  } else if (url && url.includes('vimeo.com')) {
    const videoId = url.match(/vimeo\.com\/(\d+)/)?.[1];
    if (videoId) {
      window.open(`https://player.vimeo.com/video/${videoId}?autoplay=1`, '_blank');
      return;
    }
  }
  
  if (url) {
    window.open(url, '_blank');
  }
}
</script>

{% schema %}
{
  "name": "DS LP Testimonials",
  "tag": "section",
  "class": "ds-lp-testimonials-section",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "label": "Section Label",
      "default": "Customer Stories"
    },
    {
      "type": "color",
      "id": "label_color",
      "label": "Label Color",
      "default": "#EC008C"
    },
    {
      "type": "richtext",
      "id": "headline",
      "label": "Headline",
      "default": "<h2>What Our First Customers Are Saying</h2>"
    },
    {
      "type": "text",
      "id": "tagline",
      "label": "Tagline",
      "default": "Early adopters. High-level thinkers. Now obsessed."
    }
  ],
  "blocks": [
    {
      "type": "ugc_video",
      "name": "UGC Video",
      "settings": [
        {
          "type": "image_picker",
          "id": "video_thumbnail",
          "label": "Video Thumbnail"
        },
        {
          "type": "url",
          "id": "video_url",
          "label": "Video URL",
          "info": "YouTube or Vimeo URL"
        },
        {
          "type": "text",
          "id": "video_alt",
          "label": "Alt Text",
          "default": "Video testimonial"
        }
      ]
    },
    {
      "type": "testimonial",
      "name": "Customer Testimonial",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "label": "Rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Testimonial Quote",
          "default": "Honestly didn't expect much... but I've been way more focused and calm. It's a quiet kind of energy not like a wired coffee buzz."
        },
        {
          "type": "text",
          "id": "customer_name",
          "label": "Customer Name",
          "default": "Customer Name"
        },
        {
          "type": "text",
          "id": "customer_title",
          "label": "Customer Title/Location",
          "default": "Software Engineer, Seattle"
        },
        {
          "type": "image_picker",
          "id": "profile_image",
          "label": "Profile Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "DS LP Testimonials",
      "blocks": [
        {
          "type": "ugc_video"
        },
        {
          "type": "ugc_video"
        },
        {
          "type": "ugc_video"
        },
        {
          "type": "testimonial"
        }
      ]
    }
  ]
}
{% endschema %}

